{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://github.com/Sreeram-ganesan/jaunt-data-scout/schemas/extraction.web.json",
  "title": "Web Extraction Output",
  "description": "Schema for LLM extraction output from web sources",
  "type": "object",
  "required": ["extraction_metadata", "entities"],
  "properties": {
    "extraction_metadata": {
      "type": "object",
      "description": "Metadata about the extraction process",
      "required": ["extraction_id", "source_url", "extracted_at", "extractor_version", "confidences"],
      "properties": {
        "extraction_id": {
          "type": "string",
          "pattern": "^[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}$",
          "description": "UUID for this extraction"
        },
        "correlation_id": {
          "type": "string",
          "pattern": "^[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}$",
          "description": "UUID for tracking across pipeline"
        },
        "source_url": {
          "type": "string",
          
          "description": "URL of the web source that was extracted"
        },
        "source_domain": {
          "type": "string",
          "description": "Domain of the source URL"
        },
        "content_hash": {
          "type": "string",
          "pattern": "^[a-f0-9]{64}$",
          "description": "SHA-256 hash of the source content"
        },
        "extracted_at": {
          "type": "string",
          
          "description": "When the extraction was performed"
        },
        "extractor_version": {
          "type": "string",
          "description": "Version of the extraction system"
        },
        "model_info": {
          "type": "object",
          "properties": {
            "provider": {
              "type": "string",
              "enum": ["openai", "anthropic", "bedrock", "gemini"]
            },
            "model": {
              "type": "string"
            },
            "tokens_used": {
              "type": "integer",
              "minimum": 0
            },
            "cost_estimate": {
              "type": "number",
              "minimum": 0.0
            }
          },
          "required": ["provider", "model", "tokens_used"]
        },
        "confidences": {
          "type": "object",
          "description": "Overall extraction confidence scores",
          "required": ["overall"],
          "properties": {
            "overall": {
              "type": "number",
              "minimum": 0.0,
              "maximum": 1.0,
              "description": "Overall extraction confidence"
            },
            "entity_detection": {
              "type": "number",
              "minimum": 0.0,
              "maximum": 1.0,
              "description": "Confidence in entity detection"
            },
            "location_extraction": {
              "type": "number",
              "minimum": 0.0,
              "maximum": 1.0,
              "description": "Confidence in location data extraction"
            },
            "categorization": {
              "type": "number",
              "minimum": 0.0,
              "maximum": 1.0,
              "description": "Confidence in category assignment"
            }
          },
          "additionalProperties": false
        },
        "trust_score": {
          "type": "number",
          "minimum": 0.0,
          "maximum": 1.0,
          "description": "Trust score for the source and extraction"
        }
      },
      "additionalProperties": false
    },
    "entities": {
      "type": "array",
      "description": "Array of extracted place entities",
      "items": {
        "type": "object",
        "required": ["name", "source", "source_url", "confidences"],
        "properties": {
          "name": {
            "type": "string",
            "description": "Name of the extracted place",
            "minLength": 1
          },
          "lat": {
            "type": "number",
            "minimum": -90.0,
            "maximum": 90.0,
            "description": "Optional latitude coordinate"
          },
          "lng": {
            "type": "number",
            "minimum": -180.0,
            "maximum": 180.0,
            "description": "Optional longitude coordinate"
          },
          "category": {
            "type": "string",
            "description": "Optional category classification",
            "examples": ["restaurant", "tourist_attraction", "museum", "park", "hotel"]
          },
          "source": {
            "type": "string",
            "const": "web",
            "description": "Source system identifier (always 'web' for web extractions)"
          },
          "source_url": {
            "type": "string",
            
            "description": "URL where this entity was found"
          },
          "description": {
            "type": "string",
            "description": "Optional description of the place"
          },
          "address": {
            "type": "object",
            "description": "Optional address information",
            "properties": {
              "formatted_address": {
                "type": "string"
              },
              "street": {
                "type": "string"
              },
              "city": {
                "type": "string"
              },
              "state": {
                "type": "string"
              },
              "country": {
                "type": "string"
              },
              "postal_code": {
                "type": "string"
              }
            },
            "additionalProperties": false
          },
          "contact": {
            "type": "object",
            "description": "Optional contact information",
            "properties": {
              "phone": {
                "type": "string"
              },
              "email": {
                "type": "string"
              },
              "website": {
                "type": "string"
              }
            },
            "additionalProperties": false
          },
          "confidences": {
            "type": "object",
            "description": "Confidence scores for this entity",
            "required": ["overall"],
            "properties": {
              "overall": {
                "type": "number",
                "minimum": 0.0,
                "maximum": 1.0,
                "description": "Overall confidence for this entity"
              },
              "name": {
                "type": "number",
                "minimum": 0.0,
                "maximum": 1.0,
                "description": "Confidence in name extraction"
              },
              "location": {
                "type": "number",
                "minimum": 0.0,
                "maximum": 1.0,
                "description": "Confidence in location data"
              },
              "category": {
                "type": "number",
                "minimum": 0.0,
                "maximum": 1.0,
                "description": "Confidence in category assignment"
              },
              "address": {
                "type": "number",
                "minimum": 0.0,
                "maximum": 1.0,
                "description": "Confidence in address extraction"
              }
            },
            "additionalProperties": false
          },
          "trust_score": {
            "type": "number",
            "minimum": 0.0,
            "maximum": 1.0,
            "description": "Trust score for this specific entity"
          },
          "coordinates_confidence": {
            "type": "number",
            "minimum": 0.0,
            "maximum": 1.0,
            "description": "Confidence in coordinate accuracy"
          },
          "extraction_context": {
            "type": "object",
            "description": "Context from the extraction process",
            "properties": {
              "text_snippet": {
                "type": "string",
                "description": "Relevant text snippet that mentioned this entity"
              },
              "section": {
                "type": "string",
                "description": "Section of the document where this was found"
              },
              "html_selector": {
                "type": "string",
                "description": "CSS selector or XPath for the source element"
              }
            },
            "additionalProperties": false
          }
        },
        "additionalProperties": false
      }
    }
  },
  "additionalProperties": false
}